{% extends 'pages/base.html' %}

{% load static %}

{% block title%}Sunsetious | Thanh toán{% endblock %}

{% block linkcss%}
<link rel="stylesheet" href="{%static "css/order.css"%}">
{% endblock %}
{% block imgorsearch%}{% endblock %}
{% block main%}
<div class="link">
    <a href="/">Trang Chủ</a>
    <span style="color: #000000; font-weight:bold; margin-left:5px; margin-right:5px"> > </span>
    <a href="#">Đặt vé</a>
    <span style="color: #000000; font-weight:bold; margin-left:5px; margin-right:5px"> > </span>
    <a href="/tourticket">Đặt Tour</a>
    <span style="color: #000000; font-weight:bold; margin-left:5px; margin-right:5px"> > </span>
    <a href="" style="color: #145B90">Thanh toán</a>
</div>
<section class="container">
    <div class="info">
        <div class="tour">
            <div class="image">
                
            </div>
            <div class="descriptions">
                <h3>Tour tham quan TP. Hồ Chí Minh - Nhà Thờ Đức Bà</h3>
                <span style="color: #40B4E5; font-weight:bold"><i class="fas fa-star" style="color: #FBBB00; padding-right: 3px"></i>4.5</span>
                <span>4,453 đánh giá</span>
                <span>23N+ xem</span>

                <table class="table">
                    <thead>
                        <th>Thời gian</th>
                        <th>Ngày đi</th>
                        <th>Khởi hành tại</th>
                    </thead>

                    <tr>
                        <td>1N</td>
                        <td>15/01/2021</td>
                        <td>Tp.HCM</td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="customer">
            <h3>Thông tin liên hệ</h3>
            {% if request.user.customer %}
            <form action="">
                <label for="name">Họ và tên: <span class="red">*</span></label><br>
                <input type="text" name="name" id="name" placeholder="" value="{{user.get_username}}" readonly><br>
                <label for="phone">Số điện thoại: <span class="red">*</span></label>
                <input type="tel" name="phone" id="phone" placeholder="0973194973**" value="{{user.get_userphone_number}}"><br>
                <label for="mail">Email: <span class="red">*</span></label>
                <input type="email" name="mail" id="mail" placeholder="dung111@gmail.com" value="{{user.get_useremail}}"><br>
            </form>
            {% else %}
            <div class="log-in">
                <i class="fas fa-user-circle" style="color: #2DA6D9"></i>
                <a href="/signin" style="color: #137ACA; font-weight: bold; font-size: 17px">Đăng nhập</a>
                <span style="font-size: 17px"> để đặt phòng nhanh hơn mà không cần nhập thông tin</span>
            </div>
            <form action="">
                <label for="name">Họ và tên: <span class="red">*</span></label> <br>
                <input type="text" name="name" id="name" placeholder="Mai Trong Dung" readonly> <br>
                <label for="phone">Số điện thoại: <span class="red">*</span></label>
                <input type="tel" name="phone" id="phone" placeholder="0973194973**"> <br>
                <label for="mail">Email: <span class="red">*</span></label>
                <input type="email" name="mail" id="mail" placeholder="dung111@gmail.com"> <br>
            </form>
            {% endif %}
        </div>

        <div class="voucher">
            <!-- <i class="fas fa-ticket alt"></i> -->
            <span class="giamgiabox">
                <i class="fas fa-ticket-alt fa-2x" style="color: #74C688; margin-right:20px;"></i>
                <span class="magiamgia">
                    Mã giảm giá
                </span>
            </span>

            <button id='voucher-btn' class="add">+</button>
            <div id="myModal" class="modal">

                <!-- Modal content -->
                <div class="modal-content">
                  <span class="close">&times;</span>
                  <p><b>Sử dụng giảm giá</b></p>
                  <input for='voucher' id="voucher-input" placeholder="Nhập mã giảm giá">
                  <button class="use" id='voucher-submit' onclick="closeModal()"> Áp dụng </button>
                  <p id='vouchers'></p>

                  <div class="voucher-list">
                      <div class='voucher-info'>
                          <ul>
                            <li><label> DONGGIA9 </label></li>
                            <li><label> <b>Đồng giá 888K khung 9H</b></label></li>
                            <li><span>Hạn sử dụng: 31/12/2021</span></li>
                          </ul>
                          <button class="use" onclick="closeModal()"><b>Sử dụng</b></button>
                      </div>
                  </div>
                </div>
            </div>
        </div>
        <script>
            function closeModal() {
                let modal = document.getElementById('myModal');
                modal.style.display = 'none';
            }
        </script>
        <script>
            let nVouchers = 3;
            let msg = `<b>Hoac chon mot ma giam gia duoi day</b> (${nVouchers})`;
            let vouchers = document.getElementById('vouchers');
            vouchers.innerHTML = msg;
            let modal = document.getElementById('myModal');
            let btn = document.getElementById('voucher-btn');
            let span = document.getElementsByClassName('close')[0];
            btn.onclick = function() {
                modal.style.display = 'block';
                span.onclick = function() {
                    modal.style.display = 'none';
                }

                window.onclick = function(event) {
                    if (event.target == modal) {
                        modal.style.display = 'none';
                    }
                }
            }
        </script>
        <div class="payment">
            <h3>Phương thức thanh toán</h3>
            <p>Sau khi hoàn tất thanh toán, mã xác nhận tour sẽ được gửi ngay qua SMS và Email của bạn.</p>
            <form action="">
                <div class="method">
                    <label for="qr"><i class="fas fa-qrcode" id="icon"></i> Thanh toán QR-Pay</label>
                    <input type="radio" name="pay" id="qr" value="qr">
                </div>

                <div class="method">
                    <label for="atm"> <i class="far fa-credit-card" id="icon"></i> Thanh toán thẻ ATM/Tài khoản ngân hàng</label>
                    <input type="radio" name="pay" id="atm" value="atm">
                </div>


                <div class="method">
                    <label for="visa"> <i class="fas fa-credit-card" id="icon"></i> Thanh toán thẻ visa/mastercard</label>
                    <input type="radio" name="pay" id="visa" value="visa">
                </div>


                <div class="method">
                    <label for="bank"> <i class="fas fa-money-check" id="icon"></i> Chuyển khoản ngân hàng</label>
                    <input type="radio" name="pay" id="bank" value="bank">
                </div>

            </form>
        </div>
        <div class="confirm">
            <h3>Xác nhận</h3>
            <div class="cf">
            <input type="radio" name="agree" id="agree">
            <label for="agree">Đồng ý với <a href="#" style="color: #2DA6D9">Điều kiện và điều khoản</a> của chúng tôi</label> 
            </div>
            <button class="thanhtoan"> Thanh toán</button>
        </div>
    </div>
    <div class="price-bill">
        <div class="services">
            <p class="bold" style="font-size: 25px; color: #40B4E5; font-weight: bold">Tóm tắt </p>
            <span class="bold">Tập trung:</span> <span> xe đón tận nơi
                 </span> <br>
            <span class="bold" style=" position: relative; right: 18px;"><i class="fas fa-stopwatch" style="color: #145B90"></i> Thời gian:</span> <span style=" position: relative; right: 18px;">6:30 AM - 7:00 AM</span>

            <p class="bold">Ưu đãi</p>
            <p style=" position: relative; right: 18px"><i class="fas fa-utensils" style="color: #145B90"></i> 2 bữa ăn miễn phí</p>
            <p>Bữa sáng: Bánh mì + Cà phê/sữa</p>
            <p>Bữa trưa: Cơm phần</p>

            <p class="bold">Một món quà lưu niệm</p>
            <p class="bold">Chụp 5 tấm hình free</p>
        </div>

        <div class="bill">
            <div class="container prices gray noborder">
                <label for="numbers">Số lượng: </label>
                <input onchange="reCalculate()" min="0" type="number" name="numbers" id="num" placeholder="1" value="1">
                
            </div>

            <div class="container center" style="color: #40B4E5">x</div>

            <div class="container prices gray">
                <p>Đơn giá: </p>
                <p class="price" id="price">675,873 VND</p>
            </div>
            <div class="container prices end gray">
                <p class="price" id='num-price'>675,873 VND</p>
            </div>
            <div class="container prices gray">
                <p>Vat (10%): </p>
                <p class="price" id="vat">67,587 VND</p>
            </div>
            <div class="container prices gray">
                <p><b>Thành tiền: </b></p>
                <p style="color: rgb(16, 87, 110);" class="price final" id="sum">743,460 VND</p>
            </div>
            <script>
                function reCalculate() {
                    let priceStr = document.getElementById('price').innerText;
                    priceStr = priceStr.toString().replace(',', '');
                    priceStr = priceStr.replace(' VND', '');
                    let price = Number(priceStr);

                    let numbers = Number(document.getElementById('num').value);
                    let numPrice = price * numbers;
                    let vat = Math.floor(0.1 * numPrice);
                    let total = numPrice + vat;

                    document.getElementById('price').innerHTML = price.toLocaleString() + ' VND';
                    document.getElementById('num-price').innerHTML = numPrice.toLocaleString() + ' VND';
                    document.getElementById('vat').innerHTML = vat.toLocaleString() + ' VND';
                    document.getElementById('sum').innerHTML = total.toLocaleString() + ' VND';
                }
            </script>
            <script>
                let price = 675873;
                document.getElementById('price').innerHTML = price.toLocaleString() + ' VND';
            </script>
        </div>
        
    </div>
{% endblock %}
{% block linkjs %}{% endblock %}